# Raycasting - Visual Explanation with Diagrams

This document provides visual explanations of the raycasting algorithm using ASCII art and diagrams.

---

## ğŸ¯ The Big Picture: Top-Down View

```
                        MAP (Top-Down View)
    â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
    â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  Y=0
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
    â”‚  1  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  1  â”‚  Y=1
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
    â”‚  1  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  1  â”‚  Y=2
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
    â”‚  1  â”‚  0  â”‚  0  â”‚  P  â”‚  0  â”‚  0  â”‚  0  â”‚  1  â”‚  Y=3
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
    â”‚  1  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  0  â”‚  1  â”‚  Y=4
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
    â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  1  â”‚  Y=5
    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
     X=0   X=1   X=2   X=3   X=4   X=5   X=6   X=7

Legend:
  1 = Wall (solid)
  0 = Empty space (walkable)
  P = Player position
```

---

## ğŸ“· Camera and Field of View

### Camera Setup (Looking East)

```
                       Camera Plane (perpendicular)
                              |
                              |
                     Left (-) | (+) Right
                              |
                    â•±         |         â•²
                   â•±          |          â•²
                  â•±           |           â•²
                 â•±            |            â•²        FOV â‰ˆ 66Â°
                â•±             |             â•²
               â•±              |              â•²
              â•±               |               â•²
             â•±                |                â•²
            â•±                 |                 â•²
           â•±                  |                  â•²
          â•±                   |                   â•²
         â€¢â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â€¢â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â€¢
      Ray -1            Direction (0Â°)          Ray +1
    (Left edge)        (Straight ahead)      (Right edge)
                            ğŸ‘¤
                          PLAYER
```

### Direction and Plane Vectors

```
Example 1: Looking EAST (â†’)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Direction = (1.0, 0.0)   â†’        â”‚
â”‚  Plane = (0.0, 0.66)      â†‘        â”‚
â”‚                           |         â”‚
â”‚              Left edge    |         â”‚
â”‚                    â•²      |         â”‚
â”‚                     â•²     |         â”‚
â”‚                      â•²    |         â”‚
â”‚                       â•²   |         â”‚
â”‚                        â•²  |         â”‚
â”‚                         â•² |         â”‚
â”‚                          â•²|         â”‚
â”‚         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â€¢â•â•â•â•â•â†’    â”‚
â”‚                        Player       â”‚
â”‚                          â•±|         â”‚
â”‚                         â•± |         â”‚
â”‚                        â•±  |         â”‚
â”‚                       â•±   |         â”‚
â”‚                      â•±    |         â”‚
â”‚                     â•±     |         â”‚
â”‚                    â•±      |         â”‚
â”‚              Right edge   |         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example 2: Looking NORTH (â†‘)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Direction = (0.0, -1.0)  â†‘        â”‚
â”‚  Plane = (0.66, 0.0)    â†â”€â”¼â”€â†’      â”‚
â”‚                            |         â”‚
â”‚                            |         â”‚
â”‚            Left â•±          |          â•² Right
â”‚                â•±           |           â•²
â”‚               â•±            |            â•²
â”‚              â•±             |             â•²
â”‚             â•±              â†‘              â•²
â”‚            â•±               |               â•²
â”‚           â€¢â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ‘¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â€¢
â”‚                         Player             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒŸ Ray Casting Process

### Step 1: Camera X Mapping

```
Screen columns mapped to camera space [-1.0, +1.0]

Screen:          Camera X:
  x=0        â†’   -1.0  (Left edge)
  x=320      â†’   -0.5
  x=640      â†’    0.0  (Center)
  x=960      â†’   +0.5
  x=1279     â†’   +1.0  (Right edge)

Formula: camera_x = 2 Ã— (x / 1280) - 1


         SCREEN (1280 pixels wide)
    â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
    â”‚   â”‚   â”‚   â”‚ â€¢ â”‚   â”‚   â”‚   â”‚   â”‚  â† Each column = one ray
    â”‚   â”‚   â”‚   â”‚ â€¢ â”‚   â”‚   â”‚   â”‚   â”‚
    â”‚   â”‚   â”‚   â”‚ â€¢ â”‚   â”‚   â”‚   â”‚   â”‚
    â”‚   â”‚   â”‚   â”‚ â€¢ â”‚   â”‚   â”‚   â”‚   â”‚
    â”‚   â”‚   â”‚   â”‚ â€¢ â”‚   â”‚   â”‚   â”‚   â”‚
    â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
     0               640            1279
    -1.0             0.0            +1.0
    Left          Center           Right
```

### Step 2: Ray Direction Calculation

```
ray_dir = direction + plane Ã— camera_x

Visual example (Looking East):
  Direction: (1, 0)  â†’
  Plane: (0, 0.66)   â†‘

For center ray (camera_x = 0):
  ray_dir = (1, 0) + (0, 0.66) Ã— 0
          = (1, 0)  â† Straight ahead

For right ray (camera_x = +1):
  ray_dir = (1, 0) + (0, 0.66) Ã— 1
          = (1, 0.66)  â† Northeast

For left ray (camera_x = -1):
  ray_dir = (1, 0) + (0, 0.66) Ã— (-1)
          = (1, -0.66)  â† Southeast


    â•± Left ray (1, -0.66)
   â•±
  â•±
 â•±
â€¢â•â•â•â•â•â•â•â•â†’ Center ray (1, 0)
 â•²
  â•²
   â•²
    â•² Right ray (1, 0.66)
   
   Player
```

---

## ğŸ”² DDA Algorithm Visualization

### Grid Traversal

```
DDA steps through grid cells along the ray path

Player at (3.5, 3.2), Ray direction: (0.8, 0.6)

    Y
    â†“
    0   1   2   3   4   5   6   7   X â†’
  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
0 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
1 â”‚ 1 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 1 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
2 â”‚ 1 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 1 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
3 â”‚ 1 â”‚ 0 â”‚ 0 â”‚ PÂ·â”‚Â·Â·Â·â”‚Â·Â·Â·â”‚Â·Â·â€¢â”‚ 1 â”‚  â† Ray hits wall at (6,3)
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤     Path: (3,3)â†’(4,3)â†’(5,3)â†’(6,3)
4 â”‚ 1 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 1 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
5 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚ 1 â”‚
  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

Step-by-step:
  Start: (3, 3) - Player's cell
  Step 1: Jump to x=4 â†’ Check (4, 3): Empty âœ—
  Step 2: Jump to x=5 â†’ Check (5, 3): Empty âœ—
  Step 3: Jump to x=6 â†’ Check (6, 3): Wall! âœ“ STOP
```

### Delta Distance Concept

```
How far the ray travels to cross ONE grid square

Ray direction: (0.6, 0.8)

     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
     â”‚    â”‚    â”‚    â”‚
     â”‚    â”‚  â€¢â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â†’ To cross 1 unit in X,
     â”‚   â•±â”‚   â”‚    â”‚    ray travels: 1/0.6 = 1.67
     â”‚  â•± â”‚   â”‚    â”‚
     â”‚ â•±  â”‚   â”‚    â”‚
     â”‚â•±   â”‚   â”‚    â”‚
     â€¢â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”˜
     â†‘
   Start    1.0 â†’

delta_dist_x = 1.67  (distance ray travels per X grid)
delta_dist_y = 1.25  (distance ray travels per Y grid)
```

### Side Distance - First Step

```
Player at (3.7, 2.3), Ray going right and down

     2.0     3.0     4.0     5.0
      â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤  
  2.0 â”‚       â”‚       â”‚       â”‚
      â”‚       â”‚  P    â”‚       â”‚  Player at (3.7, 2.3)
      â”‚       â”‚  â€¢    â”‚       â”‚
  3.0 â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚       â”‚  â”‚    â”‚       â”‚
      â”‚       â”‚  â†“    â”‚       â”‚
      
Distance to next grid lines:
  - Next X line: 4.0 - 3.7 = 0.3
  - Next Y line: 3.0 - 2.3 = 0.7

If ray direction = (0.8, 0.6):
  side_dist_x = 0.3 Ã— (1/0.8) = 0.375
  side_dist_y = 0.7 Ã— (1/0.6) = 1.167

Choose minimum: 0.375 < 1.167
â†’ Jump to vertical line first (X = 4.0)
```

---

## ğŸ“ Perpendicular Distance (Fisheye Correction)

### The Problem: Euclidean Distance

```
âŒ WRONG: Using actual ray length causes distortion

                Camera Plane
                     |
        Ray A        |        Ray B
         (short)     |        (long)
            â•²        |        â•±
             â•²       |       â•±
              â•²      |      â•±
               â•²     |     â•±
                â•²    |    â•±
                 â•²   |   â•±
                  â•²  |  â•±
                   â•² | â•±
                    â•²|â•±
                     P
                  Player

Ray A length = 5.0  â†’ Wall appears tall
Ray B length = 7.0  â†’ Wall appears short

Result: Curved walls (fisheye effect) ğŸ˜¢
```

### The Solution: Perpendicular Distance

```
âœ“ CORRECT: Project onto camera plane direction

                Camera Plane
                     |
        Ray A        |        Ray B
                     |
            â•²        |        â•±
             â•²       |       â•±
              â•²      |      â•±
         Â·Â·Â·Â·Â·Â·â•²Â·Â·Â·Â·Â·|Â·Â·Â·Â·Â·â•±Â·Â·Â·Â·Â·Â·  Perpendicular line
         â†‘     â•²    |    â•±      â†‘
         5.0    â•²   |   â•±       5.0
         â†‘       â•²  |  â•±        â†‘
        Same!     â•² | â•±        Same!
                   â•²|â•±
                    P
                  Player

perp_dist(A) = 5.0
perp_dist(B) = 5.0  â† Same distance!

Result: Straight walls ğŸ˜Š
```

### Mathematical Projection

```
             Wall
              |
              |  Actual ray
              | â•±
              |â•± 
    â•â•â•â•â•â•â•â•â•â•â€¢â•â•â•â•â•â•â•â•â•â•  Camera plane
              |â•²
              | â•² perp_dist
              |  â•²
              |   â•²
              |    ğŸ‘¤ Player
              
perp_dist = projection of ray onto direction vector
```

---

## ğŸ¨ Screen Projection

### Wall Height Calculation

```
Perspective projection: Farther = Smaller

Close wall (dist = 2):               Far wall (dist = 6):
    line_height = 720/2 = 360           line_height = 720/6 = 120

Screen:                             Screen:
â”Œâ”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”
â”‚    â”‚ Ceiling                      â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚ Ceiling
â”‚    â”‚                              â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚
â”œâ”€â”€â”€â”€â”¤                              â”œâ”€â”€â”€â”€â”¤
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚                              â”‚    â”‚
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚                              â”‚    â”‚
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚ Wall (360 px)                â”‚    â”‚ Wall (120 px)
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚                              â”‚    â”‚
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚                              â”‚    â”‚
â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚                              â”œâ”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”¤                              â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚ Floor
â”‚    â”‚ Floor                        â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚
â”‚    â”‚                              â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚
â””â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”˜
```

### Drawing Boundaries

```
line_height = 200
WIN_HEIGHT = 720
center = 360

start = center - line_height/2 = 360 - 100 = 260
end = center + line_height/2 = 360 + 100 = 460

    0 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚         â”‚
      â”‚ Ceiling â”‚  (solid color)
      â”‚         â”‚
  260 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â† start
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚  Wall (textured)
  360 â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚ â† center
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚
  460 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â† end
      â”‚         â”‚
      â”‚  Floor  â”‚  (solid color)
      â”‚         â”‚
  719 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¼ï¸ Texture Mapping

### Texture Selection by Direction

```
        NORTH (TEX_NO)
              â†‘
              |
              |
    WEST â†â”€â”€â”€â”€â€¢â”€â”€â”€â”€â†’ EAST
    (TEX_WE)  |   (TEX_EA)
              |
              |
              â†“
        SOUTH (TEX_SO)

If player looking East hits vertical wall:
  - ray_dir_x > 0: Show WEST texture
  - ray_dir_x < 0: Show EAST texture

If player looking North hits horizontal wall:
  - ray_dir_y < 0: Show NORTH texture
  - ray_dir_y > 0: Show SOUTH texture
```

### Texture X-Coordinate

```
Finding which column of texture to use

Wall (one grid cell):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Hit point     â”‚  Hit at position 0.73
â”‚   (wall_x=0.73) â”‚  
â”‚                 â”‚
â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0.0              1.0

Texture (64 pixels wide):
â”œâ”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¬â”¤
0         10        20        30        40   â†‘    50        60
                                           Column 46

tex_x = 0.73 Ã— 64 = 46.72 â†’ 46

Use column 46 of the texture!
```

### Texture Y-Coordinate Mapping

```
Screen wall (200 pixels):   Texture (64 pixels):
                           
  260 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             0 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚â–“        â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚  Top
      â”‚â–“â–“       â”‚              4â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
      â”‚â–“â–“â–“      â”‚              8â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
      â”‚â–“â–“â–“â–“     â”‚             12â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
      â”‚â–“â–“â–“â–“â–“    â”‚             16â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
  360 â”‚â–“â–“â–“â–“â–“â–“   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€32â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚  Middle
      â”‚â–“â–“â–“â–“â–“â–“â–“  â”‚             48â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“ â”‚             56â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
      â”‚â–“â–“â–“â–“â–“â–“â–“â–“â–“â”‚             60â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
  460 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            64 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Bottom

step = 64 / 200 = 0.32 texture pixels per screen pixel

For screen y=260: tex_y = 0
For screen y=360: tex_y = 32  (middle)
For screen y=460: tex_y = 64  (bottom)
```

### Complete Column Rendering

```
One screen column (x = 640):

  â”Œâ”€â”
  â”‚ â”‚ y=0    â†’ Ceiling color (from config)
  â”‚ â”‚ y=100  â†’ Ceiling color
  â”‚ â”‚ y=200  â†’ Ceiling color
  â”œâ”€â”¤ y=260  â†’ Wall start (tex_y=0, tex_x=46)
  â”‚â–ˆâ”‚ y=261  â†’ Wall pixel (tex_y=0, tex_x=46)
  â”‚â–ˆâ”‚ y=262  â†’ Wall pixel (tex_y=1, tex_x=46)
  â”‚â–ˆâ”‚ y=263  â†’ Wall pixel (tex_y=1, tex_x=46)
  â”‚â–ˆâ”‚  ...   â†’ ...
  â”‚â–ˆâ”‚ y=360  â†’ Wall pixel (tex_y=32, tex_x=46)
  â”‚â–ˆâ”‚  ...   â†’ ...
  â”‚â–ˆâ”‚ y=459  â†’ Wall pixel (tex_y=63, tex_x=46)
  â”œâ”€â”¤ y=460  â†’ Wall end
  â”‚ â”‚ y=461  â†’ Floor color (from config)
  â”‚ â”‚ y=600  â†’ Floor color
  â”‚ â”‚ y=719  â†’ Floor color
  â””â”€â”˜
```

---

## ğŸ”„ Complete Frame Rendering

### Full Process Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 RENDERING ONE FRAME                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  For x = 0 to 1279 (each column) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. Calculate ray direction     â”‚
        â”‚     ray_dir = dir + plane Ã— cx  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. Initialize DDA              â”‚
        â”‚     - delta_dist                â”‚
        â”‚     - side_dist                 â”‚
        â”‚     - step direction            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. DDA Loop                    â”‚
        â”‚     Step through grid until hit â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  4. Calculate perpendicular     â”‚
        â”‚     distance (fisheye fix)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  5. Calculate wall height       â”‚
        â”‚     height = WIN_HEIGHT / dist  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  6. Select texture              â”‚
        â”‚     Based on wall side/directionâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  7. Draw textured column        â”‚
        â”‚     Map texture â†’ screen pixels â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  8. Repeat for next column      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Multi-Ray Visualization

```
Top-down view showing multiple rays:

             â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
             â”‚   â”‚   â”‚   â”‚   â”‚   â”‚  Screen
             â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
                      â•‘
                     â•±â•‘â•²
                    â•± â•‘ â•²
                   â•±  â•‘  â•²
                  â•±   â•‘   â•²
                 â•±    â•‘    â•²
                â•±     â•‘     â•²
               â•±      â•‘      â•²
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â€¢â”€â”€â”€â”€â”€â”€â”€â”€â•‘â”€â”€â”€â”€â”€â”€â”€â€¢â”€â”€â”€â”€â”€â”€â”€â”€â”€  Camera plane
              â•²       â•‘      â•±
               â•²      â•‘     â•±
                â•²     â•‘    â•±
                 â•²    â•‘   â•±
     Wall â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Wall
                   â•²  â•‘  â•±
                    â•² â•‘ â•±
                     â•²â•‘â•±
                      ğŸ‘¤
                    Player

Each ray finds its wall and draws one vertical line
```

---

## ğŸ¬ Animation: Player Movement

### Rotation

```
Before:                      After (rotate right):
Direction: (1, 0) â†’         Direction: (0.707, 0.707) â†—
Plane: (0, 0.66) â†‘          Plane: (-0.466, 0.466) â†–

     â†‘                              â•±
     |                             â•±
     |                            â•±â†‘
â•â•â•â•â•â€¢â•â•â•â•â•â†’                     â•± |
   Player                    â•â•â•â€¢â•â•â•±
                              Player
                              
FOV rotates with player!
```

### Forward Movement

```
Before:                      After (move forward):
Position: (3.5, 3.5)        Position: (3.7, 3.5)

  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”      â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
  â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚      â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
  â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚      â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
  â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚      â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
  â”‚ 0 â”‚ 0 â”‚ 0 â”‚ğŸ‘¤â”‚ 0 â”‚      â”‚ 0 â”‚ 0 â”‚ 0 â”‚   ğŸ‘¤0 â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤      â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
  â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚      â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚ 0 â”‚
  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜      â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

New position = Old position + direction Ã— speed
(3.7, 3.5) = (3.5, 3.5) + (1, 0) Ã— 0.2
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAME STATE  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Player pos   â”‚ (x, y) = (5.5, 3.2)
â”‚ Direction    â”‚ (dir_x, dir_y) = (1.0, 0.0)
â”‚ Camera plane â”‚ (plane_x, plane_y) = (0.0, 0.66)
â”‚ Map grid     â”‚ char **grid
â”‚ Textures[4]  â”‚ NO, SO, WE, EA
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MAIN RENDER LOOP (render_frame)   â”‚
â”‚   For each column x = 0 to 1279:    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RAY SETUP       â”‚â”€â”€â”€â†’â”‚  t_ray struct    â”‚
â”‚  - ray_init()    â”‚    â”‚  dir_x, dir_y    â”‚
â”‚  - ray_set_step()â”‚    â”‚  map_x, map_y    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  delta_dist_x/y  â”‚
       â”‚                â”‚  side_dist_x/y   â”‚
       â†“                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DDA ALGORITHM   â”‚
â”‚  Step until hit  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WALL FOUND!     â”‚â”€â”€â”€â†’â”‚  perp_dist       â”‚
â”‚  Calculate dist  â”‚    â”‚  side (0 or 1)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  map_x, map_y    â”‚
       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROJECTION      â”‚â”€â”€â”€â†’â”‚  line_height     â”‚
â”‚  Wall height     â”‚    â”‚  draw_start      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  draw_end        â”‚
       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEXTURE MAP     â”‚â”€â”€â”€â†’â”‚  tex_index       â”‚
â”‚  Select & sample â”‚    â”‚  tex_x, tex_y    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  color           â”‚
       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DRAW COLUMN     â”‚
â”‚  Ceiling         â”‚ â† Solid color
â”‚  Wall pixels     â”‚ â† Textured
â”‚  Floor           â”‚ â† Solid color
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§® Memory Layout

### Map Grid Structure

```
t_map:
  char **grid â”€â”€â”€â”€â”
  int width = 8   â”‚
  int height = 6  â”‚
                  â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ grid[0] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "11111111\0"
     â”‚ grid[1] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "10000001\0"
     â”‚ grid[2] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "10000001\0"
     â”‚ grid[3] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "10001001\0"
     â”‚ grid[4] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "10000001\0"
     â”‚ grid[5] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ "11111111\0"
     â”‚ grid[6] â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ NULL
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Access: grid[y][x] gives character at position (x, y)
```

### Texture Image Structure

```
t_img texture[4]:
  
  texture[TEX_NO] â”€â”
  texture[TEX_SO] â”€â”¤
  texture[TEX_WE] â”€â”¤
  texture[TEX_EA] â”€â”˜
                   â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ void *ptr            â”‚ â† MLX image pointer
     â”‚ char *addr â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â†’ Pixel data
     â”‚ int bpp = 32         â”‚   (bytes per pixel)
     â”‚ int line_len = 256   â”‚   (bytes per line)
     â”‚ int endian           â”‚
     â”‚ int width = 64       â”‚
     â”‚ int height = 64      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Pixel access:
  offset = y Ã— line_len + x Ã— (bpp/8)
  color = *(int *)(addr + offset)
```

---

## ğŸ¯ Performance Optimization Visual

### Ray Casting vs Ray Tracing

```
RAYCASTING (What we do - FAST):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cast one ray per screen column â”‚
â”‚  Only check map grid            â”‚
â”‚  No recursion, no reflections   â”‚
â”‚  O(n) where n = screen width    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Player â•â•â•â†’ Wall
        â•â•â•â†’ Wall
        â•â•â•â†’ Wall
        
1280 rays per frame
@ 60 FPS = 76,800 rays/sec


RAY TRACING (Not used - SLOW):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cast multiple rays per pixel   â”‚
â”‚  Recursive bounces              â”‚
â”‚  Accurate lighting/shadows      â”‚
â”‚  O(n Ã— m Ã— bounces)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â•±â†’ Light â†— Bounce
Player â•â•±â•â•â†’ Wall â•² Bounce
        â•²         â†˜ Bounce
         â•²â†’ Reflect

Millions of rays per frame
Too slow for real-time!
```

### Cache Efficiency

```
DDA steps sequentially through memory:

Good: Stepping in X direction
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ â€¢ â”‚ â†’â”‚ â†’â”‚ â†’â”‚ â†’â”‚   Sequential access âœ“
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
grid[y][0], grid[y][1], grid[y][2]...

Less ideal: Stepping in Y direction  
â”Œâ”€â”€â”€â”
â”‚ â€¢ â”‚ â†“ grid[0][x]
â”œâ”€â”€â”€â”¤
â”‚ â€¢ â”‚ â†“ grid[1][x]
â”œâ”€â”€â”€â”¤
â”‚ â€¢ â”‚ â†“ grid[2][x]
â””â”€â”€â”€â”˜
Different cache lines
```

---

## ğŸ› Common Visual Bugs

### Fisheye Effect

```
âŒ WRONG (Euclidean distance):

     â•”â•â•â•â•â•â•â•â•â•—
    â•±          â•²      Walls look curved
   â•±            â•²     (like looking through
  â•±              â•²     a fisheye lens)
 (    PLAYER     )
  â•²              â•±
   â•²            â•±
    â•²          â•±
     â•šâ•â•â•â•â•â•â•â•â•


âœ“ CORRECT (Perpendicular distance):

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚          â”‚      Walls look straight
     â”‚          â”‚      (realistic perspective)
     â”‚  PLAYER  â”‚
     â”‚          â”‚
     â”‚          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Texture Bleeding

```
âŒ WRONG (No bounds checking):

Wall 1  â”‚  Wall 2
â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â† Textures from Wall 2
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘      appear on Wall 1!
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ


âœ“ CORRECT (Clamp tex_x):

Wall 1  â”‚  Wall 2
â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â† Each wall shows
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      its own texture
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

### Z-Fighting at Distance

```
Very far walls (large perp_dist):

âŒ line_height = 720 / 1000 = 0.72 pixels
   â†’ Rounds to 0, wall disappears!

âœ“ if (perp_dist > 0)
      line_height = max(1, 720 / perp_dist)
   â†’ Always draw at least 1 pixel
```

---

## ğŸ“ Learning Path

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         RAYCASTING MASTERY ROADMAP              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 1: Understanding
â”œâ”€ Read this visual guide
â”œâ”€ Understand top-down map view
â””â”€ Grasp ray casting concept

Level 2: Math Basics  
â”œâ”€ Vector addition/subtraction
â”œâ”€ Dot product for projection
â”œâ”€ Similar triangles
â””â”€ Trigonometry (FOV calculation)

Level 3: DDA Algorithm
â”œâ”€ Grid traversal
â”œâ”€ Delta distance calculation
â”œâ”€ Side distance tracking
â””â”€ Wall detection

Level 4: Projection
â”œâ”€ Perspective math
â”œâ”€ Fisheye correction
â”œâ”€ Screen space mapping
â””â”€ Clipping

Level 5: Textures
â”œâ”€ Texture coordinate calculation
â”œâ”€ Wall hit position
â”œâ”€ Vertical mapping
â””â”€ Color sampling

Level 6: Optimization
â”œâ”€ Fixed-point arithmetic
â”œâ”€ Cache optimization
â”œâ”€ SIMD vectorization
â””â”€ Multi-threading

Level 7: Extensions
â”œâ”€ Floor/ceiling textures
â”œâ”€ Sprites (enemies, items)
â”œâ”€ Doors and animations
â””â”€ Lighting effects
```

---

## ğŸ“š Quick Reference

### Key Formulas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  camera_x = 2 Ã— (x / WIN_WIDTH) - 1             â”‚
â”‚  ray_dir = direction + plane Ã— camera_x         â”‚
â”‚  delta_dist = |1 / ray_dir|                     â”‚
â”‚  perp_dist = side_dist - delta_dist             â”‚
â”‚  line_height = WIN_HEIGHT / perp_dist           â”‚
â”‚  start = -line_height/2 + WIN_HEIGHT/2          â”‚
â”‚  tex_x = fract(wall_hit_pos) Ã— tex_width        â”‚
â”‚  step = tex_height / line_height               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Structures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  t_player: x, y, dir_x, dir_y, plane_x, plane_yâ”‚
â”‚  t_ray: dir_x/y, map_x/y, delta_dist_x/y,      â”‚
â”‚         side_dist_x/y, step_x/y, side          â”‚
â”‚  t_map: **grid, width, height                  â”‚
â”‚  t_img: *ptr, *addr, width, height, bpp        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Made with â¤ï¸ for Cub3D learners**  
**Date:** October 24, 2025  
**Version:** 1.0 Visual Edition
